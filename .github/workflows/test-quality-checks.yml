name: Test Quality Checks Workflow

on:
  workflow_dispatch:
    inputs:
      python-version:
        description: 'Python version to test with'
        required: false
        default: '3.11'
        type: choice
        options:
          - '3.11'
          - '3.12'
      fail-on-type-errors:
        description: 'Fail on type errors'
        required: false
        default: false
        type: boolean

jobs:
  test-quality-checks:
    name: Test Quality Checks (Python ${{ inputs.python-version }})
    uses: ./.github/workflows/reusable/quality-checks.yml
    with:
      python-version: ${{ inputs.python-version }}
      check-format: true
      check-lint: true
      check-types: true
      fail-on-type-errors: ${{ inputs.fail-on-type-errors }}

  show-results:
    name: Show Test Results
    needs: test-quality-checks
    runs-on: ubuntu-latest
    steps:
      - name: Display results
        run: |
          echo "## Quality Checks Test Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Outputs from Reusable Workflow:" >> $GITHUB_STEP_SUMMARY
          echo "- **Format Result:** ${{ needs.test-quality-checks.outputs.format-result }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Lint Result:** ${{ needs.test-quality-checks.outputs.lint-result }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Type Check Result:** ${{ needs.test-quality-checks.outputs.type-result }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Type Error Count:** ${{ needs.test-quality-checks.outputs.type-error-count }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Reusable workflow executed successfully!" >> $GITHUB_STEP_SUMMARY
