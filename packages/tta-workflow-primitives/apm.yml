# apm.yml - Agent Package Configuration
# This file defines the TTA.dev package metadata, dependencies, and MCP server requirements
# Following Agent Package Manager (APM) standards for distributable agent primitives

# Package Metadata
name: tta-workflow-primitives
version: 0.1.0
description: Production-ready composable workflow primitives for building reliable, observable agent workflows
author: theinterneti
license: MIT

# Agent Primitive Types
primitives:
  instructions:
    - path: .github/instructions/*.instructions.md
      type: modular-instruction
      compile: true  # Compile to AGENTS.md

  chatmodes:
    - path: .github/chatmodes/*.chatmode.md
      type: chat-mode
      enforce_boundaries: true  # Enforce MCP tool boundaries

  workflows:
    - path: .github/workflows/*.prompt.md
      type: agentic-workflow
      runtime: multi-platform

# MCP Server Dependencies
# These define external tools/services that primitives depend on
mcp:
  servers:
    - name: filesystem
      protocol: stdio
      command: npx
      args:
        - "-y"
        - "@modelcontextprotocol/server-filesystem"
        - "/tmp"
      tools:
        - read_file
        - write_file
        - list_directory
      access: read-write

    - name: github
      protocol: stdio
      command: npx
      args:
        - "-y"
        - "@modelcontextprotocol/server-github"
      tools:
        - search_repositories
        - get_file_contents
        - list_commits
      access: read-only

    - name: tta-workflow-primitives
      protocol: stdio
      command: python
      args:
        - "-m"
        - "tta_workflow_primitives.mcp_server"
      tools:
        - compose_sequential
        - compose_parallel
        - compose_conditional
        - cache_primitive
        - timeout_primitive
        - retry_primitive
      access: read-write
      description: "Exposes TTA workflow composition operators as MCP tools"

# Package Dependencies (other agent packages)
dependencies:
  dev-primitives: "^0.1.0"

# Development Dependencies
dev_dependencies:
  apm: ">=1.0.0"

# Build Configuration
build:
  compile_context: true  # Compile modular instructions to AGENTS.md
  validate_schemas: true  # Validate MCP tool schemas
  check_boundaries: true  # Validate chat mode tool boundaries

# Testing Configuration
test:
  validate_docstrings: true  # Check LLM-friendly documentation
  validate_instructions: true  # Check instruction consistency
  run_workflows: true  # Execute agentic workflows in CI

# Distribution
publish:
  registry: github
  visibility: public

# Compatibility Matrix
compatibility:
  agents:
    - github-copilot: ">=1.0.0"
    - augment: ">=2.0.0"
    - cursor: ">=0.30.0"
    - claude: ">=3.0.0"

  standards:
    - agents-md: "1.0"
    - mcp: "0.5.0"
